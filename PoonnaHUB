--// StarterGui > ScreenGui > LocalScript
local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humRoot = char:WaitForChild("HumanoidRootPart")
local humanoid = char:WaitForChild("Humanoid")
local runService = game:GetService("RunService")
local teleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- เก็บ WalkSpeed เดิม
local normalSpeed = humanoid.WalkSpeed

-- UI ScreenGui
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.ResetOnSpawn = false

-- Frame หลัก
local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0,220,0,400)
frame.Position = UDim2.new(0.5, -110, 0.4, 0)
frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
frame.Active = true
frame.Draggable = true -- ลากได้

-- ฟังก์ชันสร้างปุ่ม
local function createButton(name, pos, text)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0,200,0,50)
	btn.Position = pos
	btn.Text = text
	btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
	btn.TextColor3 = Color3.fromRGB(255,0,0)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 18
	btn.Parent = frame
	return btn
end

-- Floating Block
local block = Instance.new("Part")
block.Size = Vector3.new(6,1,6)
block.Anchored = true
block.Material = Enum.Material.Neon
block.Parent = workspace
block.Name = "FloatBlock"
local hue = 0
local floatActive = true

-- ปุ่มเริ่ม/หยุด Floating Block
local floatBtn = createButton("FloatBtn", UDim2.new(0,10,0,40), "Floating: ON")
floatBtn.MouseButton1Click:Connect(function()
	floatActive = not floatActive
	if floatActive then
		floatBtn.Text = "Floating: ON"
	else
		floatBtn.Text = "Floating: OFF"
	end
end)

-- Hover
local hoverBtn = createButton("HoverBtn", UDim2.new(0,10,0,100), "Toggle Hover")
local hoverForce = nil
local hoverOn = false
hoverBtn.MouseButton1Click:Connect(function()
	hoverOn = not hoverOn
	if hoverOn then
		if not hoverForce then
			hoverForce = Instance.new("BodyVelocity")
			hoverForce.MaxForce = Vector3.new(0,6000,0)
			hoverForce.Velocity = Vector3.new(0,25,0)
			hoverForce.Parent = humRoot
		end
		hoverBtn.Text = "Hover: ON"
	else
		if hoverForce then hoverForce:Destroy() hoverForce = nil end
		hoverBtn.Text = "Toggle Hover"
	end
end)

-- Highlight Players
local highlightBtn = createButton("HighlightBtn", UDim2.new(0,10,0,160), "Highlight Players")
local highlightOn = false
highlightBtn.MouseButton1Click:Connect(function()
	highlightOn = not highlightOn
	if highlightOn then
		highlightBtn.Text = "Highlight: ON"
		for _, p in ipairs(Players:GetPlayers()) do
			if p ~= player and p.Character then
				if not p.Character:FindFirstChildOfClass("Highlight") then
					local hl = Instance.new("Highlight")
					hl.FillTransparency = 1
					hl.OutlineColor = Color3.new(1,1,1)
					hl.OutlineTransparency = 0
					hl.Parent = p.Character
				end
			end
		end
	else
		highlightBtn.Text = "Highlight Players"
		for _, p in ipairs(Players:GetPlayers()) do
			if p.Character and p.Character:FindFirstChildOfClass("Highlight") then
				p.Character:FindFirstChildOfClass("Highlight"):Destroy()
			end
		end
	end
end)

-- Server Hop
local serverBtn = createButton("ServerBtn", UDim2.new(0,10,0,220), "Server Hop")
serverBtn.MouseButton1Click:Connect(function()
	serverBtn.Text = "Hopping..."
	spawn(function()
		local gameId = game.PlaceId
		local servers = HttpService:JSONDecode(game:HttpGet(
			"https://games.roblox.com/v1/games/"..gameId.."/servers/Public?sortOrder=Asc&limit=100"
		))
		for _, s in ipairs(servers.data) do
			if s.playing < s.maxPlayers then
				teleportService:TeleportToPlaceInstance(gameId, s.id, player)
				break
			end
		end
	end)
end)

-- ปุ่มลอยเปิด/ปิด UI ชื่อ "P"
local toggleBtn = Instance.new("TextButton", screenGui)
toggleBtn.Size = UDim2.new(0,50,0,50)
toggleBtn.Position = UDim2.new(0,20,0,20)
toggleBtn.Text = "P"
toggleBtn.BackgroundColor3 = Color3.fromRGB(20,20,20)
toggleBtn.TextColor3 = Color3.fromRGB(255,0,0)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 24
toggleBtn.Active = true
toggleBtn.Draggable = true

local uiVisible = true
toggleBtn.MouseButton1Click:Connect(function()
	uiVisible = not uiVisible
	frame.Visible = uiVisible
end)

-- Floating Block ลอยตามเวลาเดิน
runService.RenderStepped:Connect(function()
	if humRoot and block and floatActive then
		block.CFrame = humRoot.CFrame * CFrame.new(0,-3,0)
		hue = (hue + 0.01) % 1
		block.Color = Color3.fromHSV(hue,1,1)
	end
end)
